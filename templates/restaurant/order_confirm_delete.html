{% extends 'base.html' %}

{% block title %}Delete Order - Kabul Taj Hotel{% endblock %}

{% block content %}
<!-- Module Header -->
<div class="card">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--spacing-lg);">
        <div>
            <h1 style="font-size: 2rem; font-weight: var(--font-weight-bold); color: var(--color-foreground); margin-bottom: var(--spacing-xs);">
                Delete Order
            </h1>
            <p style="color: var(--color-foreground-secondary); font-size: 1rem;">
                Confirm deletion of restaurant order
            </p>
        </div>
    </div>
</div>

<!-- Order Details -->
<div class="card">
    <div style="display: flex; flex-direction: column; gap: var(--spacing-lg);">
        <h3 style="font-size: 1.25rem; font-weight: var(--font-weight-semibold); color: var(--color-foreground);">
            Order Information
        </h3>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: var(--spacing-lg);">
            <div>
                <label style="display: block; font-weight: var(--font-weight-medium); color: var(--color-foreground-secondary); margin-bottom: var(--spacing-xs); font-size: 0.875rem;">
                    Order Number
                </label>
                <div style="font-weight: var(--font-weight-semibold); color: var(--color-foreground); font-size: 1rem;">
                    {{ order.order_number }}
                </div>
            </div>
            
            <div>
                <label style="display: block; font-weight: var(--font-weight-medium); color: var(--color-foreground-secondary); margin-bottom: var(--spacing-xs); font-size: 0.875rem;">
                    Customer Name
                </label>
                <div style="font-weight: var(--font-weight-semibold); color: var(--color-foreground); font-size: 1rem;">
                    {{ order.guest_name }}
                </div>
            </div>
            
            <div>
                <label style="display: block; font-weight: var(--font-weight-medium); color: var(--color-foreground-secondary); margin-bottom: var(--spacing-xs); font-size: 0.875rem;">
                    Table
                </label>
                <div style="font-weight: var(--font-weight-semibold); color: var(--color-foreground); font-size: 1rem;">
                    Table {{ order.table.table_number }} ({{ order.table.capacity }} seats)
                </div>
            </div>
            
            <div>
                <label style="display: block; font-weight: var(--font-weight-medium); color: var(--color-foreground-secondary); margin-bottom: var(--spacing-xs); font-size: 0.875rem;">
                    Total Amount
                </label>
                <div style="font-weight: var(--font-weight-semibold); color: var(--color-gold); font-size: 1.25rem;">
                    ${{ order.total_amount }}
                </div>
            </div>
            
            <div>
                <label style="display: block; font-weight: var(--font-weight-medium); color: var(--color-foreground-secondary); margin-bottom: var(--spacing-xs); font-size: 0.875rem;">
                    Status
                </label>
                <span style="padding: 0.25rem 0.5rem; border-radius: var(--radius-sm); font-size: 0.75rem; font-weight: var(--font-weight-medium);
                    {% if order.status == 'placed' %}background-color: var(--color-info-light); color: var(--color-info);
                    {% elif order.status == 'preparing' %}background-color: var(--color-warning-light); color: var(--color-warning);
                    {% elif order.status == 'ready' %}background-color: var(--color-warning-light); color: var(--color-warning);
                    {% elif order.status == 'served' %}background-color: var(--color-success-light); color: var(--color-success);
                    {% elif order.status == 'billed' %}background-color: var(--color-gold-light); color: var(--color-gold);
                    {% else %}background-color: var(--color-foreground-tertiary); color: var(--color-foreground);{% endif %}">
                    {{ order.get_status_display }}
                </span>
            </div>
            
            <div>
                <label style="display: block; font-weight: var(--font-weight-medium); color: var(--color-foreground-secondary); margin-bottom: var(--spacing-xs); font-size: 0.875rem;">
                    Payment Status
                </label>
                <span style="padding: 0.25rem 0.5rem; border-radius: var(--radius-sm); font-size: 0.75rem; font-weight: var(--font-weight-medium);
                    {% if order.payment_status == 'paid' %}background-color: var(--color-success-light); color: var(--color-success);
                    {% elif order.payment_status == 'pending' %}background-color: var(--color-warning-light); color: var(--color-warning);
                    {% else %}background-color: var(--color-danger-light); color: var(--color-danger);{% endif %}">
                    {{ order.get_payment_status_display }}
                </span>
            </div>
            
            <div>
                <label style="display: block; font-weight: var(--font-weight-medium); color: var(--color-foreground-secondary); margin-bottom: var(--spacing-xs); font-size: 0.875rem;">
                    Created Date
                </label>
                <div style="font-weight: var(--font-weight-semibold); color: var(--color-foreground); font-size: 1rem;">
                    {{ order.created_at|date:"M d, Y H:i" }}
                </div>
            </div>
            
            {% if order.guest %}
            <div>
                <label style="display: block; font-weight: var(--font-weight-medium); color: var(--color-foreground-secondary); margin-bottom: var(--spacing-xs); font-size: 0.875rem;">
                    Hotel Guest
                </label>
                <div style="font-weight: var(--font-weight-semibold); color: var(--color-info); font-size: 1rem;">
                    {{ order.guest.full_name }}
                </div>
            </div>
            {% elif order.room %}
            <div>
                <label style="display: block; font-weight: var(--font-weight-medium); color: var(--color-foreground-secondary); margin-bottom: var(--spacing-xs); font-size: 0.875rem;">
                    Room Service
                </label>
                <div style="font-weight: var(--font-weight-semibold); color: var(--color-success); font-size: 1rem;">
                    Room {{ order.room.room_number }}
                </div>
            </div>
            {% endif %}
        </div>
        
        {% if order.special_instructions %}
        <div>
            <label style="display: block; font-weight: var(--font-weight-medium); color: var(--color-foreground-secondary); margin-bottom: var(--spacing-xs); font-size: 0.875rem;">
                Special Instructions
            </label>
            <div style="font-weight: var(--font-weight-medium); color: var(--color-foreground); font-size: 1rem; background-color: var(--color-background-secondary); padding: var(--spacing-md); border-radius: var(--radius-md);">
                {{ order.special_instructions }}
            </div>
        </div>
        {% endif %}
    </div>
</div>

<!-- Warning Message -->
{% if not can_delete %}
<div class="card" style="border-left: 4px solid var(--color-warning); background-color: var(--color-warning-light);">
    <div style="display: flex; align-items: center; gap: var(--spacing-md);">
        <i class="fas fa-exclamation-triangle" style="color: var(--color-warning); font-size: 1.5rem;"></i>
        <div>
            <h4 style="font-weight: var(--font-weight-semibold); color: var(--color-warning); margin-bottom: var(--spacing-xs);">
                Cannot Delete Order
            </h4>
            <p style="color: var(--color-foreground); margin: 0;">
                This order cannot be deleted because it is not in a cancelled or billed status. 
                Only cancelled or billed orders can be permanently deleted from the system.
            </p>
        </div>
    </div>
</div>
{% else %}
<div class="card" style="border-left: 4px solid var(--color-danger); background-color: var(--color-danger-light);">
    <div style="display: flex; align-items: center; gap: var(--spacing-md);">
        <i class="fas fa-exclamation-triangle" style="color: var(--color-danger); font-size: 1.5rem;"></i>
        <div>
            <h4 style="font-weight: var(--font-weight-semibold); color: var(--color-danger); margin-bottom: var(--spacing-xs);">
                Warning: Permanent Deletion
            </h4>
            <p style="color: var(--color-foreground); margin: 0;">
                This action will permanently delete the order and all associated order items. 
                This action cannot be undone. Are you sure you want to proceed?
            </p>
        </div>
    </div>
</div>
{% endif %}

<!-- Action Buttons -->
<div class="card">
    <div style="display: flex; justify-content: space-between; align-items: center;">
        <a href="{% url 'restaurant:order_list' %}" class="btn btn-outline">
            <i class="fas fa-arrow-left"></i>
            Back to Orders
        </a>
        
        {% if can_delete %}
        <form method="post" style="display: inline;">
            {% csrf_token %}
            <button type="submit" class="btn btn-danger" onclick="return confirm('Are you absolutely sure you want to delete this order? This action cannot be undone.')">
                <i class="fas fa-trash"></i>
                Delete Order Permanently
            </button>
        </form>
        {% else %}
        <button type="button" class="btn btn-outline" disabled>
            <i class="fas fa-lock"></i>
            Cannot Delete
        </button>
        {% endif %}
    </div>
</div>
{% endblock %}


