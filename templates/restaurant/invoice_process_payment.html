{% extends 'base.html' %}

{% block title %}Process Payment - {{ invoice.invoice_number }}{% endblock %}

{% block content %}
<div class="card">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--spacing-lg);">
        <div>
            <h1 style="font-size: 2rem; font-weight: var(--font-weight-bold); color: var(--color-foreground); margin-bottom: var(--spacing-xs);">
                Invoice {{ invoice.invoice_number }}
            </h1>
            <p style="color: var(--color-foreground-secondary); font-size: 1rem;">
                Total: ${{ invoice.total_amount|floatformat:2 }} â€¢ Status: {{ invoice.get_status_display }}
            </p>
        </div>
        <div style="display:flex; gap: var(--spacing-sm);">
            <a href="{% url 'restaurant:invoice_receipt_pdf' invoice.pk %}" class="btn btn-secondary">
                <i class="fas fa-file-pdf"></i>
                Download Receipt (PDF)
            </a>
            <a href="{% url 'restaurant:invoice_detail' invoice.pk %}" class="btn btn-outline">
                <i class="fas fa-eye"></i>
                View Details
            </a>
        </div>
    </div>
</div>

<div style="display: grid; grid-template-columns: 2fr 1fr; gap: var(--spacing-lg);">
    <div class="card">
        <div class="card-header">
            <h2>Invoice Items</h2>
        </div>
        <div class="table-responsive">
            <table class="table">
                <thead>
                    <tr>
                        <th>Description</th>
                        <th>Qty</th>
                        <th>Unit</th>
                        <th>Total</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in invoice.items.all %}
                    <tr>
                        <td>{{ item.description }}</td>
                        <td>{{ item.quantity }}</td>
                        <td>${{ item.unit_price|floatformat:2 }}</td>
                        <td>${{ item.total_price|floatformat:2 }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <div class="card">
        <div class="card-header">
            <h2>Process Payment</h2>
        </div>
        <form method="post" style="display: grid; gap: var(--spacing-md); padding: var(--spacing-lg);">
            {% csrf_token %}
            <div>
                <label style="display:block; margin-bottom: var(--spacing-xs);">Payment Method</label>
                <select name="payment_method" style="padding: var(--spacing-sm) var(--spacing-md); background-color: var(--color-input-background); border: 1px solid var(--color-input-border); border-radius: var(--radius-md); color: var(--color-foreground); font-size: 0.875rem; min-width: 200px;">
                    <option value="">Select method</option>
                    {% for value, label in payment_method_choices %}
                    <option value="{{ value }}">{{ label }}</option>
                    {% endfor %}
                </select>
            </div>
            <div>
                <label style="display:block; margin-bottom: var(--spacing-xs);">Reference (optional)</label>
                <input type="text" name="payment_reference" style="width: 100%; padding: var(--spacing-sm) var(--spacing-md); background-color: var(--color-input-background); border: 1px solid var(--color-input-border); border-radius: var(--radius-md); color: var(--color-foreground); font-size: 0.875rem;" placeholder="Transaction ID / Note" />
            </div>
            <div>
                <button type="submit" class="btn btn-success">
                    <i class="fas fa-check"></i>
                    Confirm Payment
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}


